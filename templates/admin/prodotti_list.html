{% extends "admin/base.html" %}
{% block admin_title %}Listino Prodotti{% endblock %}

{% block admin_content %}
<!-- Navigazione Secondaria Impostazioni -->
<div style="display: flex; gap: 0.75rem; margin-bottom: 1.5rem; flex-wrap: wrap; padding-bottom: 1rem; border-bottom: 1px solid rgba(255,255,255,0.08);">
  <a href="{{ url_for('staff_admin.admin_hub') }}" class="btn btn--ghost btn--small">üè† Hub Impostazioni</a>
  <a href="{{ url_for('staff_admin.admin_list') }}" class="btn btn--ghost btn--small">üë§ Staff</a>
  <a href="{{ url_for('prodotti.admin_list') }}" class="btn btn--primary btn--small">üçπ Listino</a>
  <a href="{{ url_for('format.admin_list') }}" class="btn btn--ghost btn--small">üé≠ Format</a>
  <a href="{{ url_for('fedelta.admin_soglie') }}" class="btn btn--ghost btn--small">‚≠ê Soglie</a>
  <a href="{{ url_for('log.list') }}" class="btn btn--ghost btn--small">üìú Log</a>
</div>

<div class="products-hub">
  <header class="products-hub__header fade-in">
    <div class="products-hub__intro">
      <h1 class="products-hub__title">Listino Prodotti</h1>
      <p class="products-hub__subtitle">Gestisci disponibilit√†, prezzi e categorie per lo staff operativo.</p>
    </div>
    <div class="products-hub__actions">
      <form method="get" class="products-hub__filters">
        <label class="products-hub__filter-field">
          <span>Categoria</span>
          <input type="text" name="categoria" value="{{ filtro.categoria }}" placeholder="Es. Drink, Priv√©" class="form__input">
        </label>
      {% if filtro.categoria %}
        <a class="btn btn--ghost btn--small" href="{{ url_for('prodotti.admin_list') }}">Reset</a>
      {% endif %}
      </form>
      <a href="{{ url_for('prodotti.admin_new') }}" class="btn btn--primary btn--large">+ Nuovo prodotto</a>
    </div>
  </header>

  <section class="products-grid fade-in" style="animation-delay: 120ms;">
{% if prodotti %}
  {% for p in prodotti %}
      <article class="product-card">
        <div class="product-card__header">
          <div>
            <h2 class="product-card__title">{{ p.nome }}</h2>
            <div class="product-card__tags">
              {% if p.categoria %}
              <span class="badge badge--category">{{ p.categoria }}</span>
              {% endif %}
            </div>
        </div>
          <div class="product-card__price">‚Ç¨{{ "%.2f"|format(p.prezzo) }}</div>
        </div>

        {% if p.descrizione %}
        <p class="product-card__description">{{ p.descrizione }}</p>
        {% endif %}

        <footer class="product-card__footer">
          <div class="product-card__actions">
        <a href="{{ url_for('prodotti.admin_edit', prodotto_id=p.id_prodotto) }}" class="btn btn--primary btn--small">Modifica</a>
            <form method="post" action="{{ url_for('prodotti.admin_delete', prodotto_id=p.id_prodotto) }}" onsubmit="return confirm('Eliminare questo prodotto?');">
              <button class="btn btn--ghost btn--small">Elimina</button>
        </form>
      </div>
          <small class="product-card__hint">Ricordati di aggiornare i prezzi quando pubblichi nuove promozioni.</small>
        </footer>
  </article>
  {% endfor %}
{% else %}
      <div class="empty-state">Il listino √® vuoto. Aggiungi i primi prodotti per renderli disponibili allo staff.</div>
    {% endif %}
</section>
</div>
{% endblock %}


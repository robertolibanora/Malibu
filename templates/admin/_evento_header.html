{# Header Evento Unificato - Usato in Gestione e Dettaglio #}
{% macro render_evento_header(evento) %}
<section class="card" style="border-left: 4px solid {% if evento.stato_pubblico == 'attivo' %}#3fc380{% elif evento.stato_pubblico == 'programmato' %}#d4af37{% else %}#6b7280{% endif %};">
  <div class="card__header" style="padding: var(--spacing-4);">
    <div style="display: flex; align-items: center; justify-content: space-between; flex-wrap: wrap; gap: var(--spacing-3);">
      <!-- Nome e Info -->
      <div style="flex: 1; min-width: 200px;">
        <h1 style="font-size: var(--font-size-xl); font-weight: var(--font-weight-bold); margin: 0 0 var(--spacing-2); color: var(--admin-text);">
          {{ evento.nome_evento }}
        </h1>
        <div style="display: flex; align-items: center; gap: var(--spacing-3); flex-wrap: wrap;">
          <span style="font-size: var(--font-size-sm); color: var(--color-text-muted);">
            ğŸ“… {{ evento.data_evento.strftime('%d/%m/%Y') if evento.data_evento else 'Data da definire' }}
          </span>
          {% if evento.dj_artista %}
          <span style="font-size: var(--font-size-sm); color: var(--color-text-muted);">
            ğŸ§ {{ evento.dj_artista }}
          </span>
          {% endif %}
        </div>
      </div>

      <!-- Stato e Badge -->
      <div style="display: flex; align-items: center; gap: var(--spacing-2); flex-wrap: wrap;">
        <span class="badge badge--{{ 'success' if evento.stato_pubblico == 'attivo' else 'primary' if evento.stato_pubblico == 'programmato' else 'secondary' }}" style="font-size: var(--font-size-sm); padding: var(--spacing-2) var(--spacing-3);">
          {% if evento.stato_pubblico == 'attivo' %}âœ… ATTIVO{% elif evento.stato_pubblico == 'programmato' %}ğŸ“‹ PROGRAMMATO{% else %}ğŸ”’ CHIUSO{% endif %}
        </span>
      </div>

      <!-- Azioni Principali -->
      <div style="display: flex; align-items: center; gap: var(--spacing-2); flex-wrap: wrap;">
        <a href="{{ url_for('eventi.admin_edit', evento_id=evento.id_evento) }}" class="btn btn--primary btn--small">âœï¸ Modifica</a>
        <form method="post" action="{{ url_for('eventi.admin_duplicate', evento_id=evento.id_evento) }}" style="display: inline;">
          <button type="submit" class="btn btn--secondary btn--small" title="Duplica evento">ğŸ“‹ Duplica</button>
        </form>
        <!-- Menu Stato Evento -->
        <div class="dropdown-container" style="position: relative; display: inline-block;">
          <button type="button" class="btn btn--secondary btn--small dropdown-toggle" data-event-id="{{ evento.id_evento }}" style="display: flex; align-items: center; gap: var(--spacing-1); cursor: pointer;">
            âš™ï¸ Cambia Stato
            <span style="font-size: 0.7em; margin-left: 2px;">â–¼</span>
          </button>
          <div class="dropdown-menu" id="dropdown-{{ evento.id_evento }}" style="display: none; position: absolute; top: 100%; left: 0; margin-top: 4px; background: #1a1a1a; border: 2px solid rgba(212, 175, 55, 0.6); border-radius: 8px; box-shadow: 0 8px 32px rgba(0,0,0,0.8), 0 0 0 1px rgba(255,255,255,0.1), 0 0 20px rgba(212, 175, 55, 0.3); z-index: 10000; min-width: 240px; padding: 12px;">
            <div style="display: flex; flex-direction: column; gap: 6px;">
              <form method="post" action="{{ url_for('eventi.admin_set_stato', evento_id=evento.id_evento, stato='programmato') }}" style="margin: 0;">
                <button type="submit" class="dropdown-item" style="width: 100%; justify-content: flex-start; padding: 12px 16px; text-align: left; border-radius: 6px; border: none; background: {% if evento.stato_pubblico == 'programmato' %}rgba(212, 175, 55, 0.25); color: #d4af37; font-weight: 600; cursor: not-allowed;{% else %}transparent; color: #ffffff; cursor: pointer;{% endif %}; transition: all 0.2s;" {% if evento.stato_pubblico == 'programmato' %}disabled{% endif %} onmouseover="if(!this.disabled) {this.style.background='rgba(255,255,255,0.15)';}" onmouseout="if(!this.disabled) {this.style.background='transparent';}">
                  ğŸ“‹ Programmato{% if evento.stato_pubblico == 'programmato' %} <span style="opacity: 0.7;">(attuale)</span>{% endif %}
                </button>
              </form>
              <form method="post" action="{{ url_for('eventi.admin_set_stato', evento_id=evento.id_evento, stato='attivo') }}" style="margin: 0;">
                <button type="submit" class="dropdown-item" style="width: 100%; justify-content: flex-start; padding: 12px 16px; text-align: left; border-radius: 6px; border: none; background: {% if evento.stato_pubblico == 'attivo' %}rgba(59, 130, 246, 0.25); color: #60a5fa; font-weight: 600; cursor: not-allowed;{% else %}transparent; color: #ffffff; cursor: pointer;{% endif %}; transition: all 0.2s;" onclick="if(!this.disabled) return confirm('Attivare l\'evento? Staff e pubblico saranno attivati automaticamente.');" {% if evento.stato_pubblico == 'attivo' %}disabled{% endif %} onmouseover="if(!this.disabled) {this.style.background='rgba(255,255,255,0.15)';}" onmouseout="if(!this.disabled) {this.style.background='transparent';}">
                  âœ… Attivo{% if evento.stato_pubblico == 'attivo' %} <span style="opacity: 0.7;">(attuale)</span>{% endif %}
                </button>
              </form>
              <form method="post" action="{{ url_for('eventi.admin_set_stato', evento_id=evento.id_evento, stato='chiuso') }}" style="margin: 0;">
                <button type="submit" class="dropdown-item" style="width: 100%; justify-content: flex-start; padding: 12px 16px; text-align: left; border-radius: 6px; border: none; background: {% if evento.stato_pubblico == 'chiuso' %}rgba(107, 114, 128, 0.25); color: #9ca3af; font-weight: 600; cursor: not-allowed;{% else %}transparent; color: #ffffff; cursor: pointer;{% endif %}; transition: all 0.2s;" onclick="if(!this.disabled) return confirm('Chiudere l\'evento? Staff e pubblico saranno disattivati automaticamente.');" {% if evento.stato_pubblico == 'chiuso' %}disabled{% endif %} onmouseover="if(!this.disabled) {this.style.background='rgba(255,255,255,0.15)';}" onmouseout="if(!this.disabled) {this.style.background='transparent';}">
                  ğŸ”’ Chiuso{% if evento.stato_pubblico == 'chiuso' %} <span style="opacity: 0.7;">(attuale)</span>{% endif %}
                </button>
              </form>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</section>
{% endmacro %}




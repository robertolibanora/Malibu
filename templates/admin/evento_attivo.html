{% extends "admin/base.html" %}
{% block admin_title %}Evento Attivo{% endblock %}

{% block admin_content %}
<section class="card" style="margin-bottom: 2rem;">
  <div class="card__header">
    <div>
      <h1 class="card__title">Gestione evento attivo</h1>
      <p class="card__meta">Lo staff utilizzerà questo evento per ingressi, consumi e dashboard live.</p>
    </div>
    <div class="card__actions" style="display:flex; gap:0.75rem; flex-wrap:wrap;">
      <a href="{{ url_for('eventi.admin_menu') }}" class="btn btn--ghost">← Menu eventi</a>
      <a href="{{ url_for('staff.dashboard') }}" class="btn btn--secondary">Vai alla dashboard staff</a>
    </div>
  </div>
  {% if evento_attivo %}
    <div class="banner banner--success" style="margin-top: 1rem;">
      <strong>Evento attivo corrente:</strong> {{ evento_attivo.data_evento.strftime('%d/%m/%Y') }} — {{ evento_attivo.nome_evento }}
    </div>
  {% else %}
    <div class="banner banner--warning" style="margin-top: 1rem;">
      Nessun evento attivo impostato. Lo staff non potrà registrare ingressi o consumi finché non ne selezioni uno.
    </div>
  {% endif %}
</section>

<section class="card">
  <h2 class="card__title">Seleziona evento</h2>
  <form class="form" method="post">
    <div class="list">
      {% for e in eventi %}
      <label class="list__item" style="display:flex;gap:10px;align-items:center">
        <input type="radio" name="evento_id" value="{{ e.id_evento }}" {% if evento_attivo and evento_attivo.id_evento == e.id_evento %}checked{% endif %}>
        <div>
          <div><strong>{{ e.nome_evento }}</strong></div>
          <div class="text--muted">{{ e.data_evento.strftime('%d/%m/%Y') }} • {{ e.tipo_musica or e.categoria }}</div>
        </div>
      </label>
      {% else %}
      <p class="text--muted">Nessun evento futuro disponibile.</p>
      {% endfor %}
    </div>
    <div class="form__actions" style="margin-top:1.5rem;">
      <button class="btn btn--primary" type="submit">Imposta evento</button>
      <button class="btn btn--ghost" name="evento_id" value="clear" type="submit">Azzera evento attivo</button>
    </div>
  </form>
</section>
{% endblock %}
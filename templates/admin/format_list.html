{% extends "admin/base.html" %}
{% block admin_title %}Format Eventi{% endblock %}

{% from "admin/_page_header.html" import render_page_header %}
{% from "admin/_secondary_nav.html" import render_secondary_nav %}

{% block admin_content %}
<div class="admin-shell__content">
  {{ render_secondary_nav([
    {'url': url_for('staff_admin.admin_hub'), 'endpoint': 'staff_admin.admin_hub', 'label': 'Hub Impostazioni', 'icon': 'âš™ï¸'},
    {'url': url_for('staff_admin.admin_list'), 'endpoint': 'staff_admin.admin_list', 'label': 'Staff', 'icon': 'ğŸ‘¤'},
    {'url': url_for('prodotti.admin_list'), 'endpoint': 'prodotti.admin_list', 'label': 'Prodotti', 'icon': 'ğŸ¹'},
    {'url': url_for('promozioni.admin_list'), 'endpoint': 'promozioni.admin_list', 'label': 'Promozioni', 'icon': 'ğŸ'},
    {'url': url_for('format.admin_list'), 'endpoint': 'format.admin_list', 'label': 'Format', 'icon': 'ğŸ“‹'},
    {'url': url_for('log.list'), 'endpoint': 'log.list', 'label': 'Log', 'icon': 'ğŸ“Š'},
  ], current_endpoint=request.endpoint) }}

  {{ render_page_header(
    title="Libreria Format Eventi",
    subtitle="Gestisci i template pronti all'uso per velocizzare la creazione dei prossimi eventi",
    actions=[
      {'type': 'link', 'url': url_for('format.admin_new'), 'label': '+ Nuovo Format', 'class': 'btn--primary'}
    ],
    breadcrumbs=[
      {'label': 'Configurazione', 'url': url_for('staff_admin.admin_hub')},
      {'label': 'Format'}
    ]
  ) }}

  <!-- Lista Format -->
  <section>
    {% if formats %}
    <div class="grid grid--auto">
      {% for f in formats %}
      <article class="card">
        <div class="card__header">
          <div>
            <h2 class="card__title">{{ f.nome }}</h2>
            <div style="display: flex; flex-wrap: wrap; gap: var(--spacing-2); margin-top: var(--spacing-2);">
              {% if f.categoria %}<span class="badge badge--warning">{{ f.categoria|capitalize }}</span>{% endif %}
              {% if f.tipo_musica %}<span class="badge badge--secondary">{{ f.tipo_musica }}</span>{% endif %}
              {% if f.capienza %}<span class="badge badge--secondary">Capienza {{ f.capienza }}</span>{% endif %}
            </div>
          </div>
        </div>
        {% if f.descrizione %}
        <div class="card__content">
          <p style="margin: 0; font-size: var(--font-size-sm); color: var(--admin-text);">{{ f.descrizione }}</p>
        </div>
        {% endif %}
        <div class="card__footer">
          <div style="display: flex; gap: var(--spacing-2);">
            <a href="{{ url_for('format.admin_edit', template_id=f.id_template) }}" class="btn btn--primary btn--small">Modifica</a>
            <form method="post" action="{{ url_for('format.admin_delete', template_id=f.id_template) }}" onsubmit="return confirm('Eliminare questo format? Questa azione non puÃ² essere annullata.');" style="display: inline;">
              <button class="btn btn--danger btn--small" type="submit">Elimina</button>
            </form>
          </div>
          <small class="text--muted" style="font-size: var(--font-size-xs); margin-top: var(--spacing-2); display: block;">
            Duplica questo format quando crei un nuovo evento per mantenere coerenza nelle informazioni.
          </small>
        </div>
      </article>
      {% endfor %}
    </div>
    {% else %}
    <div class="admin-empty-state">
      <span class="admin-empty-state__icon">ğŸ­</span>
      <p class="admin-empty-state__message">Non hai ancora definito nessun format. Creane uno per accelerare la creazione dei prossimi eventi.</p>
    </div>
    {% endif %}
  </section>
</div>
{% endblock %}

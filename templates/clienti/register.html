{% extends "shared/base.html" %}
{% block title %}Registrazione - Malibù{% endblock %}
{% block body_class %}auth-page{% endblock %}

{% block content %}
<section class="auth">
  <div class="auth__brand">
    <img class="auth__brand-logo" src="{{ url_for('static', filename='img/logo.png') }}" alt="Malibù">
    <span class="auth__brand-subtitle">Crea il tuo accesso personale</span>
    <span class="auth__divider"></span>
  </div>

  <form class="auth-card form" method="post" action="{{ url_for('auth.auth_register_submit') }}" onsubmit="handleFormSubmit(event, this)">
    <div class="form__group">
      <label class="form__label" for="nome">Nome</label>
      <input class="form__input" id="nome" name="nome" required autocomplete="given-name" aria-label="Nome">
    </div>
    <div class="form__group">
      <label class="form__label" for="cognome">Cognome</label>
      <input class="form__input" id="cognome" name="cognome" required autocomplete="family-name" aria-label="Cognome">
    </div>
    <div class="form__group">
      <label class="form__label" for="telefono">Telefono</label>
      <input class="form__input" id="telefono" name="telefono" inputmode="tel" required autocomplete="tel" aria-label="Telefono">
    </div>
    <div class="form__group">
      <label class="form__label" for="data_nascita">Data di nascita</label>
      <input class="form__input" id="data_nascita" type="date" name="data_nascita" autocomplete="bday" aria-label="Data di nascita" required>
    </div>
    <div class="form__group">
      <label class="form__label" for="citta">Città</label>
      <input class="form__input" id="citta" name="citta" autocomplete="address-level2" aria-label="Città" required>
    </div>
    <div class="form__group">
      <label class="form__label" for="password_reg">Password</label>
      <input class="form__input" id="password_reg" type="password" name="password" required autocomplete="new-password" aria-label="Password" minlength="6">
      <small class="form__help">Minimo 6 caratteri</small>
    </div>
    <fieldset class="form-consents">
      <legend class="form-consents__legend">Consensi obbligatori</legend>
      <label class="form-consents__item">
        <input class="form-consents__checkbox" type="checkbox" name="accetto_termini" required>
        <span>
          Dichiaro di aver letto e accettato i
          <a href="{{ url_for('static', filename='doc/term.pdf') }}" target="_blank" rel="noopener">Termini e Condizioni</a>.
        </span>
      </label>
      <label class="form-consents__item">
        <input class="form-consents__checkbox" type="checkbox" name="accetto_privacy" required>
        <span>
          Acconsento al trattamento dei dati secondo la
          <a href="{{ url_for('static', filename='doc/privacy.pdf') }}" target="_blank" rel="noopener">Privacy Policy</a>.
        </span>
      </label>
    </fieldset>
    <div class="form__actions">
      <button class="btn btn--primary" type="submit" id="registerBtn">Registrati</button>
    </div>
    <p class="auth__alt">
      Hai già un account?
      <a href="{{ url_for('auth.auth_login_cliente_form') }}">Accedi</a>
    </p>
  </form>

  <script>
    function handleFormSubmit(event, form) {
      const submitBtn = form.querySelector('button[type="submit"]');
      if (submitBtn && !submitBtn.classList.contains('btn--loading')) {
        submitBtn.classList.add('btn--loading');
        submitBtn.disabled = true;
      }
    }
  </script>
</section>
{% endblock %}

